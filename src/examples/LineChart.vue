<template>
  <div>
    <h2>Line chart</h2>
    <div class="uk-margin-bottom">
      <vn-line :model="traffics"
        :x-format="formatDate"
        y-format=",f">
      </vn-line>
    </div>

    <div class="uk-width-medium-1-1">
      <ul class="uk-tab"
        data-uk-tab="{connect:'#tab-content'}">
        <li class="uk-active"
          aria-expanded="true">
          <a href="#">HTML</a>
        </li>
        <li aria-expanded="false"
          class="">
          <a href="#">Data</a>
        </li>
      </ul>
      <ul id="tab-content"
        class="uk-switcher uk-margin">
        <li class="uk-active">
          <pre><code>&lt;vn-line :model="traffics"
  :x-format="formatDate"
  y-format=",f"&gt;
&lt;/vn-line&gt;</code></pre>
        </li>
        <li>
          <pre><code>{{trafficData}}</code></pre>
        </li>
      </ul>
    </div>

  </div>
</template>
<script>
import Faker from 'Faker'
import _ from 'lodash'
import d3 from 'd3'

export default {
  data () {
    const gen_item = (month, day) => {
      return {
        date: new Date(`2016-${month}-${day}`).getTime(),
        visits: Faker.random.number(10000),
        views: Faker.random.number(10000),
        losses: Faker.random.number(10000),
        stay: Faker.random.number(50)
      }
    }

    const days = _.range(31)
    const month = Faker.random.number(12)

    return {
      trafficData: _.map(days, d => gen_item(month, d + 1)),
      data: [{ "pv": 1248566940, "uv": 676918276, "trend": { "pv": { "1532304000": 38629236, "1532390400": 35800225, "1532476800": 38110085, "1532563200": 36106189, "1532649600": 35613946, "1532736000": 35433750, "1532822400": 36237118, "1532908800": 36024264, "1532995200": 35271407, "1533081600": 34289917, "1533168000": 35285192, "1533254400": 34163030, "1533340800": 35383122, "1533427200": 38468168, "1533513600": 37178736, "1533600000": 43562344, "1533686400": 36107972, "1533772800": 34930717, "1533859200": 38557700, "1533945600": 39546565, "1534032000": 43386731, "1534118400": 40809736, "1534204800": 43197632, "1534291200": 40131778, "1534377600": 45643661, "1534464000": 46596524, "1534550400": 40482429, "1534636800": 44205325, "1534723200": 49339872, "1534809600": 58191729, "1534896000": 61881840 }, "uv": { "1532304000": 20905559, "1532390400": 19463320, "1532476800": 20969075, "1532563200": 19511177, "1532649600": 19442308, "1532736000": 19250773, "1532822400": 19567225, "1532908800": 19642675, "1532995200": 19184949, "1533081600": 18913199, "1533168000": 19128290, "1533254400": 18280191, "1533340800": 18779469, "1533427200": 20484984, "1533513600": 19724801, "1533600000": 23451186, "1533686400": 19485753, "1533772800": 18874788, "1533859200": 21149216, "1533945600": 22044585, "1534032000": 23630024, "1534118400": 22004148, "1534204800": 23581971, "1534291200": 21609221, "1534377600": 25863933, "1534464000": 26690538, "1534550400": 22141185, "1534636800": 24059515, "1534723200": 26057927, "1534809600": 30833054, "1534896000": 32193237 } }, "key": "\u6e38\u620f\u5185", "originalKey": "ingame", "percent": 0.9721181350731986 }, { "pv": 23936529, "uv": 18097078, "percent": 0.0186366731219117, "key": "\u5176\u5b83", "trend": { "pv": { "1532304000": 674646, "1532390400": 546909, "1532476800": 483792, "1532563200": 414469, "1532649600": 542690, "1532736000": 531539, "1532822400": 536308, "1532908800": 576147, "1532995200": 584994, "1533081600": 712964, "1533168000": 994693, "1533254400": 653440, "1533340800": 649116, "1533427200": 1082236, "1533513600": 1095647, "1533600000": 1070701, "1533686400": 816999, "1533772800": 867449, "1533859200": 1597379, "1533945600": 1171929, "1534032000": 1410759, "1534118400": 939697, "1534204800": 890767, "1534291200": 577867, "1534377600": 711818, "1534464000": 614958, "1534550400": 576086, "1534636800": 618160, "1534723200": 730884, "1534809600": 606537, "1534896000": 654949 }, "uv": { "1532304000": 510658, "1532390400": 427436, "1532476800": 376607, "1532563200": 318649, "1532649600": 405774, "1532736000": 398486, "1532822400": 406118, "1532908800": 433765, "1532995200": 435597, "1533081600": 555019, "1533168000": 695733, "1533254400": 504023, "1533340800": 509812, "1533427200": 768092, "1533513600": 812257, "1533600000": 830464, "1533686400": 634520, "1533772800": 672511, "1533859200": 1148003, "1533945600": 907883, "1534032000": 1029522, "1534118400": 697628, "1534204800": 680233, "1534291200": 452698, "1534377600": 543966, "1534464000": 476225, "1534550400": 446882, "1534636800": 480011, "1534723200": 562455, "1534809600": 470294, "1534896000": 505757 } } }, { "pv": 9501093, "uv": 6025981, "trend": { "pv": { "1532304000": 301655, "1532390400": 316366, "1532476800": 298663, "1532563200": 279366, "1532649600": 260108, "1532736000": 244998, "1532822400": 224283, "1532908800": 269405, "1532995200": 276159, "1533081600": 296883, "1533168000": 296959, "1533254400": 291604, "1533340800": 268787, "1533427200": 256272, "1533513600": 377464, "1533600000": 389640, "1533686400": 343163, "1533772800": 345563, "1533859200": 328223, "1533945600": 338425, "1534032000": 284918, "1534118400": 322926, "1534204800": 351346, "1534291200": 340110, "1534377600": 341462, "1534464000": 307706, "1534550400": 276416, "1534636800": 267473, "1534723200": 325506, "1534809600": 331035, "1534896000": 348209 }, "uv": { "1532304000": 192182, "1532390400": 207441, "1532476800": 194095, "1532563200": 180095, "1532649600": 163891, "1532736000": 153578, "1532822400": 139510, "1532908800": 169692, "1532995200": 176805, "1533081600": 191340, "1533168000": 186561, "1533254400": 184487, "1533340800": 171508, "1533427200": 159673, "1533513600": 234021, "1533600000": 247167, "1533686400": 218226, "1533772800": 219846, "1533859200": 206110, "1533945600": 217243, "1534032000": 176544, "1534118400": 204667, "1534204800": 228712, "1534291200": 214908, "1534377600": 202516, "1534464000": 197245, "1534550400": 176743, "1534636800": 166452, "1534723200": 209814, "1534809600": 212392, "1534896000": 222517 } }, "key": "PC", "originalKey": "pc", "percent": 0.007397428613893158 }, { "pv": 1566305, "uv": 1108077, "trend": { "pv": { "1532304000": 108813, "1532390400": 64358, "1532476800": 44405, "1532563200": 39160, "1532649600": 37153, "1532736000": 28787, "1532822400": 27917, "1532908800": 36097, "1532995200": 48516, "1533081600": 36405, "1533168000": 32514, "1533254400": 34128, "1533340800": 32848, "1533427200": 34207, "1533513600": 65785, "1533600000": 71644, "1533686400": 42607, "1533772800": 43811, "1533859200": 62147, "1533945600": 53096, "1534032000": 49568, "1534118400": 66420, "1534204800": 76224, "1534291200": 55361, "1534377600": 48762, "1534464000": 50707, "1534550400": 40685, "1534636800": 41534, "1534723200": 67974, "1534809600": 55682, "1534896000": 68990 }, "uv": { "1532304000": 90157, "1532390400": 46253, "1532476800": 32888, "1532563200": 29783, "1532649600": 27820, "1532736000": 20710, "1532822400": 20011, "1532908800": 26209, "1532995200": 34725, "1533081600": 23613, "1533168000": 21534, "1533254400": 22881, "1533340800": 22131, "1533427200": 23091, "1533513600": 39377, "1533600000": 48287, "1533686400": 28673, "1533772800": 29389, "1533859200": 48769, "1533945600": 39617, "1534032000": 37070, "1534118400": 45412, "1534204800": 55074, "1534291200": 40366, "1534377600": 33601, "1534464000": 34957, "1534550400": 27339, "1534636800": 28200, "1534723200": 46127, "1534809600": 38458, "1534896000": 45555 } }, "key": "\u5fae\u4fe1", "originalKey": "wx", "percent": 0.0012195048953929746 }, { "pv": 744108, "uv": 662284, "trend": { "pv": { "1532304000": 113114, "1532390400": 31403, "1532476800": 45118, "1532563200": 14964, "1532649600": 11214, "1532736000": 16362, "1532822400": 9927, "1532908800": 8952, "1532995200": 9400, "1533081600": 13212, "1533168000": 8384, "1533254400": 8435, "1533340800": 8793, "1533427200": 9879, "1533513600": 36304, "1533600000": 45681, "1533686400": 21998, "1533772800": 18992, "1533859200": 49418, "1533945600": 24048, "1534032000": 16573, "1534118400": 16038, "1534204800": 21118, "1534291200": 20503, "1534377600": 22417, "1534464000": 22079, "1534550400": 13838, "1534636800": 14107, "1534723200": 29076, "1534809600": 36252, "1534896000": 26509 }, "uv": { "1532304000": 110706, "1532390400": 28781, "1532476800": 40882, "1532563200": 13051, "1532649600": 9805, "1532736000": 14347, "1532822400": 8605, "1532908800": 7429, "1532995200": 7824, "1533081600": 11494, "1533168000": 6956, "1533254400": 6717, "1533340800": 7201, "1533427200": 8285, "1533513600": 31405, "1533600000": 41182, "1533686400": 20101, "1533772800": 17092, "1533859200": 47207, "1533945600": 21681, "1534032000": 14894, "1534118400": 14208, "1534204800": 17526, "1534291200": 17969, "1534377600": 18929, "1534464000": 18011, "1534550400": 11411, "1534636800": 11684, "1534723200": 23967, "1534809600": 31092, "1534896000": 21842 } }, "key": "QQ", "originalKey": "qq", "percent": 0.000579352902979353 }, { "pv": 55418, "uv": 42369, "trend": { "pv": { "1533168000": 230, "1533254400": 792, "1533340800": 530, "1533427200": 400, "1533513600": 525, "1533600000": 531, "1533686400": 2329, "1533772800": 2723, "1533859200": 610, "1533945600": 555, "1534032000": 535, "1534118400": 523, "1534204800": 751, "1534291200": 958, "1534377600": 2011, "1534464000": 3998, "1534550400": 6737, "1534636800": 5397, "1534723200": 21263, "1534809600": 2886, "1534896000": 1134 }, "uv": { "1533168000": 209, "1533254400": 664, "1533340800": 448, "1533427200": 312, "1533513600": 469, "1533600000": 436, "1533686400": 2237, "1533772800": 2591, "1533859200": 521, "1533945600": 429, "1534032000": 424, "1534118400": 450, "1534204800": 582, "1534291200": 799, "1534377600": 554, "1534464000": 2341, "1534550400": 4156, "1534636800": 4401, "1534723200": 17345, "1534809600": 2110, "1534896000": 891 } }, "key": "\u52a9\u624bAPP", "originalKey": "helper", "percent": 4.314774088883574e-5 }, { "pv": 7395, "uv": 4697, "trend": { "pv": { "1533859200": 58, "1533945600": 334, "1534032000": 456, "1534118400": 367, "1534204800": 420, "1534291200": 388, "1534377600": 374, "1534464000": 490, "1534550400": 681, "1534636800": 1553, "1534723200": 1294, "1534809600": 424, "1534896000": 556 }, "uv": { "1533859200": 41, "1533945600": 220, "1534032000": 347, "1534118400": 254, "1534204800": 283, "1534291200": 283, "1534377600": 265, "1534464000": 292, "1534550400": 383, "1534636800": 951, "1534723200": 792, "1534809600": 276, "1534896000": 310 } }, "key": "\u65b0\u6d6a\u5fae\u535a", "originalKey": "weibo", "percent": 5.7576517354097995e-6 }]
    }
  },
  mounted () {
    setTimeout(() => {
      this.data = [{ "pv": 2248566940, "uv": 676918276, "trend": { "pv": { "1532304000": 38629236, "1532390400": 35800225, "1532476800": 38110085, "1532563200": 36106189, "1532649600": 35613946, "1532736000": 35433750, "1532822400": 36237118, "1532908800": 36024264, "1532995200": 35271407, "1533081600": 34289917, "1533168000": 35285192, "1533254400": 34163030, "1533340800": 35383122, "1533427200": 38468168, "1533513600": 37178736, "1533600000": 43562344, "1533686400": 36107972, "1533772800": 34930717, "1533859200": 38557700, "1533945600": 39546565, "1534032000": 43386731, "1534118400": 40809736, "1534204800": 43197632, "1534291200": 40131778, "1534377600": 45643661, "1534464000": 46596524, "1534550400": 40482429, "1534636800": 44205325, "1534723200": 49339872, "1534809600": 58191729, "1534896000": 61881840 }, "uv": { "1532304000": 20905559, "1532390400": 19463320, "1532476800": 20969075, "1532563200": 19511177, "1532649600": 19442308, "1532736000": 19250773, "1532822400": 19567225, "1532908800": 19642675, "1532995200": 19184949, "1533081600": 18913199, "1533168000": 19128290, "1533254400": 18280191, "1533340800": 18779469, "1533427200": 20484984, "1533513600": 19724801, "1533600000": 23451186, "1533686400": 19485753, "1533772800": 18874788, "1533859200": 21149216, "1533945600": 22044585, "1534032000": 23630024, "1534118400": 22004148, "1534204800": 23581971, "1534291200": 21609221, "1534377600": 25863933, "1534464000": 26690538, "1534550400": 22141185, "1534636800": 24059515, "1534723200": 26057927, "1534809600": 30833054, "1534896000": 32193237 } }, "key": "\u6e38\u620f\u5185", "originalKey": "ingame", "percent": 0.9721181350731986 }, { "pv": 23936529, "uv": 18097078, "percent": 0.0186366731219117, "key": "\u5176\u5b83", "trend": { "pv": { "1532304000": 674646, "1532390400": 546909, "1532476800": 483792, "1532563200": 414469, "1532649600": 542690, "1532736000": 531539, "1532822400": 536308, "1532908800": 576147, "1532995200": 584994, "1533081600": 712964, "1533168000": 994693, "1533254400": 653440, "1533340800": 649116, "1533427200": 1082236, "1533513600": 1095647, "1533600000": 1070701, "1533686400": 816999, "1533772800": 867449, "1533859200": 1597379, "1533945600": 1171929, "1534032000": 1410759, "1534118400": 939697, "1534204800": 890767, "1534291200": 577867, "1534377600": 711818, "1534464000": 614958, "1534550400": 576086, "1534636800": 618160, "1534723200": 730884, "1534809600": 606537, "1534896000": 654949 }, "uv": { "1532304000": 510658, "1532390400": 427436, "1532476800": 376607, "1532563200": 318649, "1532649600": 405774, "1532736000": 398486, "1532822400": 406118, "1532908800": 433765, "1532995200": 435597, "1533081600": 555019, "1533168000": 695733, "1533254400": 504023, "1533340800": 509812, "1533427200": 768092, "1533513600": 812257, "1533600000": 830464, "1533686400": 634520, "1533772800": 672511, "1533859200": 1148003, "1533945600": 907883, "1534032000": 1029522, "1534118400": 697628, "1534204800": 680233, "1534291200": 452698, "1534377600": 543966, "1534464000": 476225, "1534550400": 446882, "1534636800": 480011, "1534723200": 562455, "1534809600": 470294, "1534896000": 505757 } } }, { "pv": 9501093, "uv": 6025981, "trend": { "pv": { "1532304000": 301655, "1532390400": 316366, "1532476800": 298663, "1532563200": 279366, "1532649600": 260108, "1532736000": 244998, "1532822400": 224283, "1532908800": 269405, "1532995200": 276159, "1533081600": 296883, "1533168000": 296959, "1533254400": 291604, "1533340800": 268787, "1533427200": 256272, "1533513600": 377464, "1533600000": 389640, "1533686400": 343163, "1533772800": 345563, "1533859200": 328223, "1533945600": 338425, "1534032000": 284918, "1534118400": 322926, "1534204800": 351346, "1534291200": 340110, "1534377600": 341462, "1534464000": 307706, "1534550400": 276416, "1534636800": 267473, "1534723200": 325506, "1534809600": 331035, "1534896000": 348209 }, "uv": { "1532304000": 192182, "1532390400": 207441, "1532476800": 194095, "1532563200": 180095, "1532649600": 163891, "1532736000": 153578, "1532822400": 139510, "1532908800": 169692, "1532995200": 176805, "1533081600": 191340, "1533168000": 186561, "1533254400": 184487, "1533340800": 171508, "1533427200": 159673, "1533513600": 234021, "1533600000": 247167, "1533686400": 218226, "1533772800": 219846, "1533859200": 206110, "1533945600": 217243, "1534032000": 176544, "1534118400": 204667, "1534204800": 228712, "1534291200": 214908, "1534377600": 202516, "1534464000": 197245, "1534550400": 176743, "1534636800": 166452, "1534723200": 209814, "1534809600": 212392, "1534896000": 222517 } }, "key": "PC", "originalKey": "pc", "percent": 0.007397428613893158 }, { "pv": 1566305, "uv": 1108077, "trend": { "pv": { "1532304000": 108813, "1532390400": 64358, "1532476800": 44405, "1532563200": 39160, "1532649600": 37153, "1532736000": 28787, "1532822400": 27917, "1532908800": 36097, "1532995200": 48516, "1533081600": 36405, "1533168000": 32514, "1533254400": 34128, "1533340800": 32848, "1533427200": 34207, "1533513600": 65785, "1533600000": 71644, "1533686400": 42607, "1533772800": 43811, "1533859200": 62147, "1533945600": 53096, "1534032000": 49568, "1534118400": 66420, "1534204800": 76224, "1534291200": 55361, "1534377600": 48762, "1534464000": 50707, "1534550400": 40685, "1534636800": 41534, "1534723200": 67974, "1534809600": 55682, "1534896000": 68990 }, "uv": { "1532304000": 90157, "1532390400": 46253, "1532476800": 32888, "1532563200": 29783, "1532649600": 27820, "1532736000": 20710, "1532822400": 20011, "1532908800": 26209, "1532995200": 34725, "1533081600": 23613, "1533168000": 21534, "1533254400": 22881, "1533340800": 22131, "1533427200": 23091, "1533513600": 39377, "1533600000": 48287, "1533686400": 28673, "1533772800": 29389, "1533859200": 48769, "1533945600": 39617, "1534032000": 37070, "1534118400": 45412, "1534204800": 55074, "1534291200": 40366, "1534377600": 33601, "1534464000": 34957, "1534550400": 27339, "1534636800": 28200, "1534723200": 46127, "1534809600": 38458, "1534896000": 45555 } }, "key": "\u5fae\u4fe1", "originalKey": "wx", "percent": 0.0012195048953929746 }, { "pv": 744108, "uv": 662284, "trend": { "pv": { "1532304000": 113114, "1532390400": 31403, "1532476800": 45118, "1532563200": 14964, "1532649600": 11214, "1532736000": 16362, "1532822400": 9927, "1532908800": 8952, "1532995200": 9400, "1533081600": 13212, "1533168000": 8384, "1533254400": 8435, "1533340800": 8793, "1533427200": 9879, "1533513600": 36304, "1533600000": 45681, "1533686400": 21998, "1533772800": 18992, "1533859200": 49418, "1533945600": 24048, "1534032000": 16573, "1534118400": 16038, "1534204800": 21118, "1534291200": 20503, "1534377600": 22417, "1534464000": 22079, "1534550400": 13838, "1534636800": 14107, "1534723200": 29076, "1534809600": 36252, "1534896000": 26509 }, "uv": { "1532304000": 110706, "1532390400": 28781, "1532476800": 40882, "1532563200": 13051, "1532649600": 9805, "1532736000": 14347, "1532822400": 8605, "1532908800": 7429, "1532995200": 7824, "1533081600": 11494, "1533168000": 6956, "1533254400": 6717, "1533340800": 7201, "1533427200": 8285, "1533513600": 31405, "1533600000": 41182, "1533686400": 20101, "1533772800": 17092, "1533859200": 47207, "1533945600": 21681, "1534032000": 14894, "1534118400": 14208, "1534204800": 17526, "1534291200": 17969, "1534377600": 18929, "1534464000": 18011, "1534550400": 11411, "1534636800": 11684, "1534723200": 23967, "1534809600": 31092, "1534896000": 21842 } }, "key": "QQ", "originalKey": "qq", "percent": 0.000579352902979353 }, { "pv": 55418, "uv": 42369, "trend": { "pv": { "1533168000": 230, "1533254400": 792, "1533340800": 530, "1533427200": 400, "1533513600": 525, "1533600000": 531, "1533686400": 2329, "1533772800": 2723, "1533859200": 610, "1533945600": 555, "1534032000": 535, "1534118400": 523, "1534204800": 751, "1534291200": 958, "1534377600": 2011, "1534464000": 3998, "1534550400": 6737, "1534636800": 5397, "1534723200": 21263, "1534809600": 2886, "1534896000": 1134 }, "uv": { "1533168000": 209, "1533254400": 664, "1533340800": 448, "1533427200": 312, "1533513600": 469, "1533600000": 436, "1533686400": 2237, "1533772800": 2591, "1533859200": 521, "1533945600": 429, "1534032000": 424, "1534118400": 450, "1534204800": 582, "1534291200": 799, "1534377600": 554, "1534464000": 2341, "1534550400": 4156, "1534636800": 4401, "1534723200": 17345, "1534809600": 2110, "1534896000": 891 } }, "key": "\u52a9\u624bAPP", "originalKey": "helper", "percent": 4.314774088883574e-5 }, { "pv": 7395, "uv": 4697, "trend": { "pv": { "1533859200": 58, "1533945600": 334, "1534032000": 456, "1534118400": 367, "1534204800": 420, "1534291200": 388, "1534377600": 374, "1534464000": 490, "1534550400": 681, "1534636800": 1553, "1534723200": 1294, "1534809600": 424, "1534896000": 556 }, "uv": { "1533859200": 41, "1533945600": 220, "1534032000": 347, "1534118400": 254, "1534204800": 283, "1534291200": 283, "1534377600": 265, "1534464000": 292, "1534550400": 383, "1534636800": 951, "1534723200": 792, "1534809600": 276, "1534896000": 310 } }, "key": "\u65b0\u6d6a\u5fae\u535a", "originalKey": "weibo", "percent": 5.7576517354097995e-6 }];
    }, 2000);
  },
  computed: {
    traffics () {
      let formatTrendPV = (trendData) => {
        let {
          pv
        } = trendData;
        let pvValue = [];
        for (let key in pv) {
          let x = key * 1000;
          pvValue.push({
            x,
            y: pv[key]
          });
        }
        return pvValue;
      }
      return this.data.map((item) => {
        return {
          key: item.key,
          values: formatTrendPV(item.trend)
        }
      })
      // return [
      //   {
      //     key: 'visits',
      //     // area: true,
      //     values: _.map(this.trafficData, (t) => {
      //       return {
      //         x: t.date,
      //         y: t.visits
      //       }
      //     })
      //   },
      //   {
      //     key: 'views',
      //     // bar: true,
      //     values: _.map(this.trafficData, (t) => {
      //       return {
      //         x: t.date,
      //         y: t.views
      //       }
      //     })
      //   },
      //   {
      //     key: 'losses',
      //     // area: true,
      //     values: _.map(this.trafficData, (t) => {
      //       return {
      //         x: t.date,
      //         y: t.losses
      //       }
      //     })
      //   }
      // ]
    }
  },
  methods: {
    formatDate (d) {
      return d3.time.format('%x')(new Date(d))
    }
  }
}
</script>
